# Do not edit this file
# This file is autogenerated using jsonnet
apiVersion: v1
kind: ConfigMap
metadata:
  creationTimestamp: null
  name: dashboards
  labels:
    app.kubernetes.io/name: prometheus-statefulset
    app.kubernetes.io/component: grafana
data:
  api.json: |
    {"__requires":[{"type":"grafana","id":"grafana","name":"Grafana","version":"6.0.0-beta3"},{"type":"panel","id":"graph","name":"Graph","version":"5.0.0"},{"type":"datasource","id":"prometheus","name":"prometheus","version":"5.0.0"},{"type":"panel","id":"singlestat","name":"Singlestat","version":"5.0.0"},{"type":"panel","id":"text","name":"Text","version":"5.0.0"}],"annotations":{"list":[]},"editable":true,"gnetId":null,"graphTooltip":0,"id":null,"iteration":1551877044611,"links":[],"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":27,"panels":[],"title":"General","type":"row"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["#d44a3a","rgba(237,129,40,0.89)","#299c46"],"format":"none","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":9,"w":12,"x":0,"y":1},"id":8,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":false},"tableColumn":"","targets":[{"expr":"sum(rate(api_service_emojify_called_count{status!=\"200\"}[1m])+rate(api_service_cache_called_count{status!=\"200\"}[1m]))+sum(rate(api_service_error_injected[1m]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"","refId":"A"}],"thresholds":"","title":"APIerrors/s","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["#d44a3a","rgba(237,129,40,0.89)","#299c46"],"description":"","format":"none","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":9,"w":12,"x":12,"y":1},"id":6,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":true},"tableColumn":"__name__","targets":[{"expr":"sum(rate(api_service_emojify_called_count{status=\"200\"}[1m])+rate(api_service_cache_called_count{status=\"200\"}[1m]))","format":"time_series","intervalFactor":1,"legendFormat":"Success","refId":"A"}],"thresholds":"","title":"APIrequests/s","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":12,"x":0,"y":10},"id":21,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(container_cpu_usage_seconds_total{container_name!=\"POD\",pod_name=~\"emojify-api-.*\",name=~\"^k8s_.*\"}[1m]))by(container_name)","format":"time_series","intervalFactor":1,"legendFormat":"","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PodCPU","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":12,"x":12,"y":10},"id":23,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(container_memory_working_set_bytes{container_name!=\"POD\",name=~\"^k8s_.*\",pod_name=~\"emojify-api-.*\"})by(container_name)","format":"time_series","intervalFactor":1,"legendFormat":"","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PODMemory","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":18},"id":29,"panels":[],"title":"EnvoyStats","type":"row"},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":9,"w":19,"x":0,"y":19},"id":13,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideZero":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_ext_authz_connect_authz_ok{label_app=\"emojify-api\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"ok","refId":"A"},{"expr":"sum(increase(envoy_ext_authz_connect_authz_error{label_app=\"emojify-api\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"error","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EnvoyAuthz","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"content":"#Authz\nEnvoywillcloseaconnectionwhicheithertimesoutorreturnsanerrorstate:[https://github.com/envoyproxy/envoy/issues/5023](https://github.com/envoyproxy/envoy/issues/5023)\n","gridPos":{"h":9,"w":5,"x":19,"y":19},"id":14,"links":[],"mode":"markdown","targets":[{"expr":"envoy_ext_authz_connect_authz_error","format":"time_series","intervalFactor":1,"legendFormat":"","refId":"A"}],"timeFrom":null,"timeShift":null,"title":"EnvoyAuthzError","type":"text"},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":11,"w":24,"x":0,"y":28},"id":18,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_http_downstream_cx_total{envoy_http_conn_manager_prefix=\"ingress_api\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"total","refId":"A"},{"expr":"sum(increase(envoy_http_downstream_cx_active{envoy_http_conn_manager_prefix=\"ingress_api\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"active","refId":"B"},{"expr":"sum(increase(envoy_http_downstream_cx_destroy_remote{envoy_http_conn_manager_prefix=\"ingress_api\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"destroy-remote","refId":"E"},{"expr":"sum(increase(envoy_http_downstream_cx_destroy_local{envoy_http_conn_manager_prefix=\"ingress_api\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"destroy-local","refId":"C"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EnvoyConnections-downstream","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":39},"id":16,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideZero":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_http_downstream_rq_xx{envoy_http_conn_manager_prefix=\"ingress_api\",name=~\"^$pod_name$\"}[30s]))by(envoy_response_code_class,name)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{envoy_response_code_class}}xx-{{name}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EnvoyInboundRequests(downstream)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":47},"id":32,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideZero":true,"max":true,"min":true,"rightSide":false,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"nullaszero","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(rate(envoy_http_downstream_cx_tx_bytes_total{envoy_http_conn_manager_prefix=\"ingress_api\",name=~\"^$pod_name$\"}[30s]))by(name)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{envoy_response_code_class}}xx-{{name}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EnvoyConnectionsDataTransferred(persecond)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":55},"id":31,"panels":[],"title":"ApplicationStatistics","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":56},"id":11,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":false,"hideEmpty":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"nullaszero","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(api_service_cache_called_sum{name=~\"^$pod_name$\"}[10s])/rate(api_service_cache_called_count{name=~\"^$pod_name$\"}[10s]))by(status)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{status}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EmojifyAPIRequestDuration/cacheGET(ms)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":64},"id":24,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":false,"hideEmpty":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"nullaszero","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(api_service_emojify_called_sum{name=~\"^$pod_name$\"}[30s])/rate(api_service_emojify_called_count{name=~\"^$pod_name$\"}[30s]))by(status)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{status}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EmojifyAPIRequestDuration/POST(ms)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":72},"id":19,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":false,"hideEmpty":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(api_service_health_called_sum{name=~\"^$pod_name$\"}[1m])/rate(api_service_health_called_count{name=~\"^$pod_name$\"}[1m]))by(status)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{status}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EmojifyAPIRequestDuration/healthGET(ms)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"description":"TimetakenforupstreamfaceboxAPItodetectfacesinanimage","fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":80},"id":10,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":false,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"nullaszero","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(api_service_emojify_find_faces_sum{name=~\"^$pod_name$\"}[30s])/rate(api_service_emojify_find_faces_count{name=~\"^$pod_name$\"}[30s]))by(status)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{status}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EmojifyFaceDetectDuration","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"ms","label":"","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":88},"id":25,"legend":{"alignAsTable":true,"avg":true,"current":false,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"sum(increase(api_service_emojify_cache_check_count{name=~\"^$pod_name$\"}[30s]))by(status)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{status}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EmojifyCacheHits","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"short","label":"","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":96},"id":2,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":false,"hideEmpty":false,"hideZero":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"increase(api_service_health_called_count[1m])","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{ip}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"HealthChecks","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":"10s","schemaVersion":18,"style":"dark","tags":["emojify"],"templating":{"list":[{"allValue":null,"current":{},"datasource":"prometheus","definition":"query_result(sum(api_service_health_called_count)by(name))","hide":0,"includeAll":true,"label":null,"multi":false,"name":"pod_name","options":[],"query":"query_result(sum(api_service_health_called_count)by(name))","refresh":1,"regex":"/\"([^\"]+)\"/","skipUrlSync":false,"sort":0,"tagValuesQuery":"$name","tags":[],"tagsQuery":"query_result(envoy_ext_authz_connect_authz_ok{label_app=\"emojify-api\"})","type":"query","useTags":false}]},"time":{"from":"now-30m","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"lab04-API","uid":null,"version":2}
  cache.json: |
    {"__requires":[{"type":"panel","id":"gauge","name":"Gauge","version":""},{"type":"grafana","id":"grafana","name":"Grafana","version":"6.0.0-beta3"},{"type":"panel","id":"graph","name":"Graph","version":"5.0.0"},{"type":"datasource","id":"prometheus","name":"prometheus","version":"5.0.0"}],"annotations":{"list":[]},"editable":true,"gnetId":null,"graphTooltip":0,"id":null,"iteration":1551878036466,"links":[],"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":26,"panels":[],"title":"GeneralStatistics","type":"row"},{"gridPos":{"h":8,"w":12,"x":0,"y":1},"id":6,"links":[],"options":{"maxValue":100,"minValue":0,"showThresholdLabels":false,"showThresholdMarkers":true,"thresholds":[{"color":"#7EB26D","index":0,"value":null}],"valueMappings":[],"valueOptions":{"decimals":0,"prefix":"","stat":"avg","suffix":"","unit":"none"}},"targets":[{"expr":"sum(rate(cache_service_cache_get_count{status=\"200\"}[60s])+rate(cache_service_cache_put_count{status=\"200\"}[60s]))+sum(rate(cache_service_cache_exists_count{status=\"302\"}[60s]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"","refId":"A"}],"timeFrom":null,"timeShift":null,"title":"Cacherequests/s","type":"gauge"},{"gridPos":{"h":8,"w":12,"x":12,"y":1},"id":10,"links":[],"options":{"maxValue":100,"minValue":0,"showThresholdLabels":false,"showThresholdMarkers":true,"thresholds":[{"color":"#F2495C","index":0,"value":null}],"valueMappings":[],"valueOptions":{"decimals":0,"prefix":"","stat":"avg","suffix":"","unit":"none"}},"targets":[{"expr":"sum(rate(cache_service_cache_exists{status=~\"5.*\"}[60s])+rate(cache_service_cache_put{status=~\"5.*\"}[60s])+rate(cache_service_cache_get{status=~\"5.*\"}[60s]))+sum(rate(cache_service_cache_exists_count{status=~\"5.*\"}[60s]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"","refId":"A"}],"timeFrom":null,"timeShift":null,"title":"Errors/s","type":"gauge"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":7,"w":12,"x":0,"y":9},"id":12,"interval":"","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(rate(container_cpu_usage_seconds_total{container_name!=\"POD\",pod_name=~\"emojify-cache-.*\",name=~\"^k8s_.*\"}[1m]))by(container_name)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{container_name}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PodCPU","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"none","label":"cores","logBase":1,"max":null,"min":null,"show":true},{"format":"none","label":"","logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":7,"w":12,"x":12,"y":9},"id":14,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(container_memory_working_set_bytes{container_name!=\"POD\",name=~\"^k8s_.*\",pod_name=~\"emojify-cache-.*\"})by(container_name)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{container_name}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PodMemoryUsage","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decbytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":16},"id":28,"panels":[],"title":"EnvoyStatistics","type":"row"},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":17},"id":18,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"increase(envoy_http_downstream_cx_total{envoy_http_conn_manager_prefix=\"ingress_cache\",name=~\"^$pod_name$\"}[1m])","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"total","refId":"A"},{"expr":"sum(increase(envoy_http_downstream_cx_active{envoy_http_conn_manager_prefix=\"ingress_cache\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","intervalFactor":1,"legendFormat":"active","refId":"B"},{"expr":"sum(increase(envoy_http_downstream_cx_destroy_remote{envoy_http_conn_manager_prefix=\"ingress_cache\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","intervalFactor":1,"legendFormat":"destroy-remote","refId":"C"},{"expr":"sum(increase(envoy_http_downstream_cx_destroy_local{envoy_http_conn_manager_prefix=\"ingress_cache\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","intervalFactor":1,"legendFormat":"destroy-local","refId":"D"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"CurrentEnvoyUpstreamConnections","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"description":"","fill":1,"gridPos":{"h":7,"w":24,"x":0,"y":25},"id":16,"interval":"","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"rate(envoy_ext_authz_connect_authz_ok{name=~\"emojify-cache.*\"}[30s])","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{name}}-ok","refId":"A"},{"expr":"rate(envoy_ext_authz_connect_authz_error{name=~\"emojify-cache.*\"}[30s])","format":"time_series","intervalFactor":1,"legendFormat":"{{name}}-error","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EnvoyAuthz","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":10,"w":24,"x":0,"y":32},"id":2,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":true,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_cluster_grpc_0{label_app=\"emojify-cache\"}[30s]))by(envoy_grpc_bridge_method)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{envoy_grpc_bridge_method}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"CacheSuccessgRPC","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":42},"id":19,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"rightSide":false,"show":true,"total":true,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_cluster_grpc_failure{label_app=\"emojify-cache\"}[30s]))by(envoy_grpc_bridge_method)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{envoy_grpc_bridge_method}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"CacheFailuregRPC","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"description":"","fill":1,"gridPos":{"h":7,"w":24,"x":0,"y":50},"id":4,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"show":true,"total":true,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_cluster_grpc_5{label_app=\"emojify-cache\"}[30s]))by(envoy_grpc_bridge_method)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{envoy_grpc_bridge_method}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"CacheNotFoundgRPC","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":57},"id":30,"panels":[],"title":"ApplicationStatistics","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":7,"w":24,"x":0,"y":58},"id":21,"interval":"","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"nullaszero","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"rate(cache_service_cache_get_sum[30s])/rate(cache_service_cache_get_count[30s])","format":"time_series","intervalFactor":1,"legendFormat":"{{name}}-{{status}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"CacheGet(ms)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":7,"w":24,"x":0,"y":65},"id":22,"legend":{"avg":false,"current":false,"hideZero":true,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"nullaszero","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"rate(cache_service_cache_put_sum[30s])/rate(cache_service_cache_put_count[30s])","format":"time_series","intervalFactor":1,"legendFormat":"{{name}}-{{status}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"CachePut(ms)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"description":"","fill":1,"gridPos":{"h":8,"w":12,"x":0,"y":72},"id":8,"interval":"","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"cache_service_cache_invalidate_sum/cache_service_cache_invalidate_count","format":"time_series","intervalFactor":1,"legendFormat":"{{name}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Cacheinvalidation(ms)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":12,"x":12,"y":72},"id":24,"interval":"","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"increase(cache_service_cache_invalidated[30s])","format":"time_series","intervalFactor":1,"legendFormat":"{{name}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"CacheInvalidatedItems","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":"10s","schemaVersion":18,"style":"dark","tags":["emojify"],"templating":{"list":[{"allValue":null,"current":{},"datasource":"prometheus","definition":"query_result(sum(cache_service_cache_get)by(name))","hide":0,"includeAll":true,"label":"","multi":false,"name":"pod_name","options":[],"query":"query_result(sum(cache_service_cache_get)by(name))","refresh":1,"regex":"/\"([^\"]+)\"/","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-30m","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"lab04-Cache","uid":null,"version":4}
  ingress.json: |
    {"__requires":[{"type":"grafana","id":"grafana","name":"Grafana","version":"6.0.0-beta3"},{"type":"panel","id":"graph","name":"Graph","version":"5.0.0"},{"type":"datasource","id":"prometheus","name":"prometheus","version":"5.0.0"},{"type":"panel","id":"singlestat","name":"Singlestat","version":"5.0.0"}],"annotations":{"list":[]},"editable":true,"gnetId":null,"graphTooltip":0,"id":null,"iteration":1551860227955,"links":[],"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":25,"panels":[],"title":"StandardMetics","type":"row"},{"cacheTimeout":null,"colorBackground":false,"colorPrefix":false,"colorValue":false,"colors":["#d44a3a","rgba(237,129,40,0.89)","#299c46"],"description":"Numberofinboundrequestspersecond","format":"none","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":8,"w":12,"x":0,"y":1},"id":20,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":true},"tableColumn":"","targets":[{"expr":"sum(rate(envoy_http_downstream_rq_xx{envoy_http_conn_manager_prefix=~\"service:emojify-api|service:emojify-website\",label_app=\"emojify-ingress\",envoy_response_code_class=~\"2|4\"}[60s]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"","refId":"A"}],"thresholds":"","timeFrom":null,"timeShift":null,"title":"Requests/s","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorPrefix":false,"colorValue":false,"colors":["#299c46","rgba(237,129,40,0.89)","#d44a3a"],"description":"Numberofoutbounderrorspersecond","format":"none","gauge":{"maxValue":10,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":8,"w":12,"x":12,"y":1},"id":21,"interval":null,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"repeat":null,"repeatDirection":"h","sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":true},"tableColumn":"","targets":[{"expr":"sum(rate(envoy_http_downstream_rq_xx{envoy_http_conn_manager_prefix=~\"service:emojify-api|service:emojify-website\",label_app=\"emojify-ingress\",envoy_response_code_class=\"5\"}[60s]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"","refId":"A"}],"thresholds":"2,5,10","timeFrom":null,"timeShift":null,"title":"Errors/s","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":12,"x":0,"y":9},"id":12,"interval":"","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(container_cpu_usage_seconds_total{container_name!=\"POD\",pod_name=~\"emojify-ingress-.*\",name=~\"^k8s_.*\"}[1m]))by(container_name)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{container_name}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PodCPU","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":12,"x":12,"y":9},"id":14,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(container_memory_working_set_bytes{container_name!=\"POD\",name=~\"^k8s_.*\",pod_name=~\"emojify-ingress-.*\"})by(container_name)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{container_name}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PodMemory","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":9,"w":24,"x":0,"y":17},"id":2,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideZero":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_http_downstream_rq_xx{envoy_http_conn_manager_prefix=~\"service:emojify-api|service:emojify-website\",label_app=\"emojify-ingress\"}[30s]))by(envoy_response_code_class)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{envoy_response_code_class}}xx","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EnvoyListenerRequestsInbound(Downstream)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":9,"w":12,"x":0,"y":26},"id":6,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideZero":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_cluster_upstream_rq_xx{label_app=\"emojify-ingress\",envoy_cluster_name=\"service_emojify-api\"}[30s]))by(envoy_response_code_class)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{envoy_response_code_class}}xx-","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"APIUpstreamRequests","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":9,"w":12,"x":12,"y":26},"id":17,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideZero":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_cluster_upstream_rq_xx{label_app=\"emojify-ingress\",envoy_cluster_name=\"service_emojify-website\"}[30s]))by(envoy_response_code_class)","format":"time_series","intervalFactor":1,"legendFormat":"{{envoy_response_code_class}}xxx","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"WebsiteUpstreamRequests","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"alert":{"conditions":[{"evaluator":{"params":[400],"type":"gt"},"operator":{"type":"and"},"query":{"params":["A","5m","now"]},"reducer":{"params":[],"type":"percent_diff"},"type":"query"}],"executionErrorState":"alerting","for":"5m","frequency":"1m","handler":1,"message":"APIRequeststimeshavesloweddramatically","name":"APIRequests(ms)alert","noDataState":"no_data","notifications":[{"uid":"2PZBOr9ik"}]},"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":12,"x":0,"y":35},"id":10,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"nullaszero","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(envoy_cluster_upstream_rq_time_sum{envoy_cluster_name=\"service_emojify-api\"}[30s])/rate(envoy_cluster_upstream_rq_time_count{envoy_cluster_name=\"service_emojify-api\"}[30s]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"allpods","refId":"A"}],"thresholds":[{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":400}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"APIRequests(ms)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":"","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"alert":{"conditions":[{"evaluator":{"params":[100],"type":"gt"},"operator":{"type":"and"},"query":{"params":["A","5m","now"]},"reducer":{"params":[],"type":"percent_diff"},"type":"query"}],"executionErrorState":"alerting","for":"5m","frequency":"1m","handler":1,"message":"Websiterequesttimeshavesloweddramatically","name":"WebsiteRequests(ms)alert","noDataState":"no_data","notifications":[{"uid":"2PZBOr9ik"}]},"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":12,"x":12,"y":35},"id":9,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"nullaszero","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(envoy_cluster_upstream_rq_time_sum{envoy_cluster_name=\"service_emojify-website\"}[30s])/rate(envoy_cluster_upstream_rq_time_count{envoy_cluster_name=\"service_emojify-website\"}[30s]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"allpods","refId":"A"}],"thresholds":[{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":100,"yaxis":"left"}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"WebsiteRequests(ms)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ms","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":43},"id":27,"panels":[],"title":"ReliabilityMetrics","type":"row"},{"alert":{"conditions":[{"evaluator":{"params":[1],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C","5m","now"]},"reducer":{"params":[],"type":"count"},"type":"query"}],"executionErrorState":"alerting","for":"5m","frequency":"1m","handler":1,"name":"APIUpstreamTimeoutsalert","noDataState":"no_data","notifications":[]},"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":9,"w":12,"x":0,"y":44},"id":23,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideZero":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_cluster_upstream_rq_timeout{label_app=\"emojify-ingress\",envoy_cluster_name=\"service_emojify-api\"}[30s]))","format":"time_series","intervalFactor":1,"legendFormat":"timeout","refId":"C"}],"thresholds":[{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":1}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"APIUpstreamTimeouts","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"alert":{"conditions":[{"evaluator":{"params":[1],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C","5m","now"]},"reducer":{"params":[],"type":"count"},"type":"query"}],"executionErrorState":"alerting","for":"5m","frequency":"1m","handler":1,"name":"WebsiteUpstreamTimeoutsalert","noDataState":"no_data","notifications":[]},"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":9,"w":12,"x":12,"y":44},"id":29,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideZero":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_cluster_upstream_rq_timeout{label_app=\"emojify-ingress\",envoy_cluster_name=\"service_emojify-website\"}[30s]))","format":"time_series","intervalFactor":1,"legendFormat":"timeout","refId":"C"}],"thresholds":[{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":1}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"WebsiteUpstreamTimeouts","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"alert":{"conditions":[{"evaluator":{"params":[1],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C","5m","now"]},"reducer":{"params":[],"type":"count"},"type":"query"}],"executionErrorState":"alerting","for":"5m","frequency":"1m","handler":1,"name":"APIUpstreamRetriesalert","noDataState":"no_data","notifications":[]},"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":9,"w":12,"x":0,"y":53},"id":22,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideZero":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_cluster_retry_upstream_rq_xx{label_app=\"emojify-ingress\",envoy_cluster_name=\"service_emojify-api\"}[30s]))","format":"time_series","intervalFactor":1,"legendFormat":"retries","refId":"C"}],"thresholds":[{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":1}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"APIUpstreamRetries","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"alert":{"conditions":[{"evaluator":{"params":[1],"type":"gt"},"operator":{"type":"and"},"query":{"params":["C","5m","now"]},"reducer":{"params":[],"type":"count"},"type":"query"}],"executionErrorState":"alerting","for":"5m","frequency":"1m","handler":1,"name":"WebsiteUpstreamRetriesalert","noDataState":"no_data","notifications":[]},"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":9,"w":12,"x":12,"y":53},"id":28,"interval":"","legend":{"alignAsTable":true,"avg":true,"current":true,"hideZero":true,"max":true,"min":true,"show":true,"total":false,"values":true},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_cluster_retry_upstream_rq_xx{label_app=\"emojify-ingress\",envoy_cluster_name=\"service_emojify-website\"}[30s]))","format":"time_series","intervalFactor":1,"legendFormat":"retries","refId":"C"}],"thresholds":[{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":1}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"WebsiteUpstreamRetries","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"alert":{"conditions":[{"evaluator":{"params":[0],"type":"gt"},"operator":{"type":"and"},"query":{"params":["B","5m","now"]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"executionErrorState":"alerting","for":"5m","frequency":"1m","handler":1,"message":"IngressserviceishavingdifficultycontactingoneormoreupstreamAPIservices","name":"APIOutlierEjectionsalert","noDataState":"no_data","notifications":[{"uid":"2PZBOr9ik"}]},"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":12,"x":0,"y":62},"id":16,"interval":"","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(envoy_cluster_outlier_detection_ejections_active{envoy_cluster_name=\"service_emojify-api\"})by(label_app)","format":"time_series","intervalFactor":1,"legendFormat":"{{label_app}}","refId":"B"}],"thresholds":[{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":0}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"APIOutlierEjections","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"alert":{"conditions":[{"evaluator":{"params":[0],"type":"gt"},"operator":{"type":"and"},"query":{"params":["A","5m","now"]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"executionErrorState":"alerting","for":"5m","frequency":"1m","handler":1,"message":"Ingressishavingdifficultycontactingoneormoreupstreamwebsiteservices","name":"WebsiteOutlierEjectionsActivealert","noDataState":"no_data","notifications":[{"uid":"2PZBOr9ik"}]},"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":12,"x":12,"y":62},"id":18,"interval":"","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"envoy_cluster_outlier_detection_ejections_active{envoy_cluster_name=\"service_emojify-website\"}","format":"time_series","intervalFactor":1,"legendFormat":"{{label_app}}","refId":"A"}],"thresholds":[{"colorMode":"critical","fill":true,"line":true,"op":"gt","value":0}],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"WebsiteOutlierEjectionsActive","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":"10s","schemaVersion":18,"style":"dark","tags":["emojify"],"templating":{"list":[{"allValue":null,"current":{},"datasource":"prometheus","definition":"query_result(sum(api_service_health_called_count)by(name))","hide":0,"includeAll":true,"label":null,"multi":false,"name":"pod_name","options":[],"query":"query_result(sum(api_service_health_called_count)by(name))","refresh":1,"regex":"/\"([^\"]+)\"/","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-5m","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"lab04-Ingress","uid":null,"version":14}
  k8s.json: |
    {"__requires":[{"type":"grafana","id":"grafana","name":"Grafana","version":"6.0.0-beta3"},{"type":"panel","id":"graph","name":"Graph","version":"5.0.0"},{"type":"datasource","id":"prometheus","name":"prometheus","version":"5.0.0"},{"type":"panel","id":"singlestat","name":"Singlestat","version":"5.0.0"}],"annotations":{"list":[]},"description":"MonitorsKubernetesclusterusingprometheus.ShowsoverallclusterCPU/Memory/Filesystemusageaswellasindividualpod,containers,systemdservicesstatistics.UsescAdvisormetricsonly.","editable":true,"gnetId":315,"graphTooltip":0,"id":null,"iteration":1551111255081,"links":[],"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":33,"panels":[],"title":"NetworkI/Opressure","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus","decimals":2,"editable":true,"error":false,"fill":1,"grid":{},"gridPos":{"h":5,"w":24,"x":0,"y":1},"height":"200px","id":32,"isNew":true,"legend":{"alignAsTable":false,"avg":true,"current":true,"max":false,"min":false,"rightSide":false,"show":false,"sideWidth":200,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"connected","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(container_network_receive_bytes_total{kubernetes_io_hostname=~\"^$Node$\"}[1m]))","interval":"10s","intervalFactor":1,"legendFormat":"Received","metric":"network","refId":"A","step":10},{"expr":"-sum(rate(container_network_transmit_bytes_total{kubernetes_io_hostname=~\"^$Node$\"}[1m]))","interval":"10s","intervalFactor":1,"legendFormat":"Sent","metric":"network","refId":"B","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"NetworkI/Opressure","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"Bps","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":6},"id":34,"panels":[],"title":"Totalusage","type":"row"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50,172,45,0.97)","rgba(237,129,40,0.89)","rgba(245,54,54,0.9)"],"datasource":"prometheus","editable":true,"error":false,"format":"percent","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":5,"w":8,"x":0,"y":7},"height":"180px","id":4,"interval":null,"isNew":true,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":false},"tableColumn":"","targets":[{"expr":"sum(container_memory_working_set_bytes{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"})/sum(machine_memory_bytes{kubernetes_io_hostname=~\"^$Node$\"})*100","interval":"10s","intervalFactor":1,"refId":"A","step":10}],"thresholds":"65,90","title":"Clustermemoryusage","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50,172,45,0.97)","rgba(237,129,40,0.89)","rgba(245,54,54,0.9)"],"datasource":"prometheus","decimals":2,"editable":true,"error":false,"format":"percent","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":5,"w":8,"x":8,"y":7},"height":"180px","id":6,"interval":null,"isNew":true,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":false},"tableColumn":"","targets":[{"expr":"sum(rate(container_cpu_usage_seconds_total{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))/sum(machine_cpu_cores{kubernetes_io_hostname=~\"^$Node$\"})*100","interval":"10s","intervalFactor":1,"refId":"A","step":10}],"thresholds":"65,90","title":"ClusterCPUusage(1mavg)","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":true,"colors":["rgba(50,172,45,0.97)","rgba(237,129,40,0.89)","rgba(245,54,54,0.9)"],"datasource":"prometheus","decimals":2,"editable":true,"error":false,"format":"percent","gauge":{"maxValue":100,"minValue":0,"show":true,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":5,"w":8,"x":16,"y":7},"height":"180px","id":7,"interval":null,"isNew":true,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":false},"tableColumn":"","targets":[{"expr":"sum(container_fs_usage_bytes{device=~\"^/dev/[sv]d[a-z][1-9]$\",id=\"/\",kubernetes_io_hostname=~\"^$Node$\"})/sum(container_fs_limit_bytes{device=~\"^/dev/[sv]d[a-z][1-9]$\",id=\"/\",kubernetes_io_hostname=~\"^$Node$\"})*100","interval":"10s","intervalFactor":1,"legendFormat":"","metric":"","refId":"A","step":10}],"thresholds":"65,90","title":"Clusterfilesystemusage","type":"singlestat","valueFontSize":"80%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50,172,45,0.97)","rgba(237,129,40,0.89)","rgba(245,54,54,0.9)"],"datasource":"prometheus","decimals":2,"editable":true,"error":false,"format":"bytes","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":4,"x":0,"y":12},"height":"1px","id":9,"interval":null,"isNew":true,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"20%","prefix":"","prefixFontSize":"20%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":false},"tableColumn":"","targets":[{"expr":"sum(container_memory_working_set_bytes{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"})","interval":"10s","intervalFactor":1,"refId":"A","step":10}],"thresholds":"","title":"Used","type":"singlestat","valueFontSize":"50%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50,172,45,0.97)","rgba(237,129,40,0.89)","rgba(245,54,54,0.9)"],"datasource":"prometheus","decimals":2,"editable":true,"error":false,"format":"bytes","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":4,"x":4,"y":12},"height":"1px","id":10,"interval":null,"isNew":true,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":false},"tableColumn":"","targets":[{"expr":"sum(machine_memory_bytes{kubernetes_io_hostname=~\"^$Node$\"})","interval":"10s","intervalFactor":1,"refId":"A","step":10}],"thresholds":"","title":"Total","type":"singlestat","valueFontSize":"50%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50,172,45,0.97)","rgba(237,129,40,0.89)","rgba(245,54,54,0.9)"],"datasource":"prometheus","decimals":2,"editable":true,"error":false,"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":4,"x":8,"y":12},"height":"1px","id":11,"interval":null,"isNew":true,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"cores","postfixFontSize":"30%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":false},"tableColumn":"","targets":[{"expr":"sum(rate(container_cpu_usage_seconds_total{id=\"/\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))","interval":"10s","intervalFactor":1,"refId":"A","step":10}],"thresholds":"","title":"Used","type":"singlestat","valueFontSize":"50%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50,172,45,0.97)","rgba(237,129,40,0.89)","rgba(245,54,54,0.9)"],"datasource":"prometheus","decimals":2,"editable":true,"error":false,"format":"none","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":4,"x":12,"y":12},"height":"1px","id":12,"interval":null,"isNew":true,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"cores","postfixFontSize":"30%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":false},"tableColumn":"","targets":[{"expr":"sum(machine_cpu_cores{kubernetes_io_hostname=~\"^$Node$\"})","interval":"10s","intervalFactor":1,"refId":"A","step":10}],"thresholds":"","title":"Total","type":"singlestat","valueFontSize":"50%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50,172,45,0.97)","rgba(237,129,40,0.89)","rgba(245,54,54,0.9)"],"datasource":"prometheus","decimals":2,"editable":true,"error":false,"format":"bytes","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":4,"x":16,"y":12},"height":"1px","id":13,"interval":null,"isNew":true,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":false},"tableColumn":"","targets":[{"expr":"sum(container_fs_usage_bytes{device=~\"^/dev/[sv]d[a-z][1-9]$\",id=\"/\",kubernetes_io_hostname=~\"^$Node$\"})","interval":"10s","intervalFactor":1,"refId":"A","step":10}],"thresholds":"","title":"Used","type":"singlestat","valueFontSize":"50%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"cacheTimeout":null,"colorBackground":false,"colorValue":false,"colors":["rgba(50,172,45,0.97)","rgba(237,129,40,0.89)","rgba(245,54,54,0.9)"],"datasource":"prometheus","decimals":2,"editable":true,"error":false,"format":"bytes","gauge":{"maxValue":100,"minValue":0,"show":false,"thresholdLabels":false,"thresholdMarkers":true},"gridPos":{"h":3,"w":4,"x":20,"y":12},"height":"1px","id":14,"interval":null,"isNew":true,"links":[],"mappingType":1,"mappingTypes":[{"name":"valuetotext","value":1},{"name":"rangetotext","value":2}],"maxDataPoints":100,"nullPointMode":"connected","nullText":null,"postfix":"","postfixFontSize":"50%","prefix":"","prefixFontSize":"50%","rangeMaps":[{"from":"null","text":"N/A","to":"null"}],"sparkline":{"fillColor":"rgba(31,118,189,0.18)","full":false,"lineColor":"rgb(31,120,193)","show":false},"tableColumn":"","targets":[{"expr":"sum(container_fs_limit_bytes{device=~\"^/dev/[sv]d[a-z][1-9]$\",id=\"/\",kubernetes_io_hostname=~\"^$Node$\"})","interval":"10s","intervalFactor":1,"refId":"A","step":10}],"thresholds":"","title":"Total","type":"singlestat","valueFontSize":"50%","valueMaps":[{"op":"=","text":"N/A","value":"null"}],"valueName":"current"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":15},"id":35,"panels":[],"title":"PodsCPUusage","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus","decimals":3,"editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":24,"x":0,"y":16},"height":"","id":17,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"connected","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":true,"targets":[{"expr":"sum(rate(container_cpu_usage_seconds_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(pod_name)","interval":"10s","intervalFactor":1,"legendFormat":"{{pod_name}}","metric":"container_cpu","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PodsCPUusage(1mavg)","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"none","label":"cores","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":23},"id":36,"panels":[{"aliasColors":{},"bars":false,"datasource":"prometheus","decimals":3,"editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":24,"x":0,"y":23},"height":"","id":23,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":true,"targets":[{"expr":"sum(rate(container_cpu_usage_seconds_total{systemd_service_name!=\"\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(systemd_service_name)","hide":false,"interval":"10s","intervalFactor":1,"legendFormat":"{{systemd_service_name}}","metric":"container_cpu","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"SystemservicesCPUusage(1mavg)","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"show":true},"yaxes":[{"format":"none","label":"cores","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}]}],"title":"SystemservicesCPUusage","type":"row"},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":24},"id":37,"panels":[{"aliasColors":{},"bars":false,"datasource":"prometheus","decimals":3,"editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":24,"x":0,"y":24},"height":"","id":24,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"hideEmpty":false,"hideZero":false,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":null,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":true,"targets":[{"expr":"sum(rate(container_cpu_usage_seconds_total{image!=\"\",name=~\"^k8s_.*\",container_name!=\"POD\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(container_name,pod_name)","hide":false,"interval":"10s","intervalFactor":1,"legendFormat":"pod:{{pod_name}}|{{container_name}}","metric":"container_cpu","refId":"A","step":10},{"expr":"sum(rate(container_cpu_usage_seconds_total{image!=\"\",name!~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(kubernetes_io_hostname,name,image)","hide":false,"interval":"10s","intervalFactor":1,"legendFormat":"docker:{{kubernetes_io_hostname}}|{{image}}({{name}})","metric":"container_cpu","refId":"B","step":10},{"expr":"sum(rate(container_cpu_usage_seconds_total{rkt_container_name!=\"\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(kubernetes_io_hostname,rkt_container_name)","interval":"10s","intervalFactor":1,"legendFormat":"rkt:{{kubernetes_io_hostname}}|{{rkt_container_name}}","metric":"container_cpu","refId":"C","step":10}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"ContainersCPUusage(1mavg)","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"show":true},"yaxes":[{"format":"none","label":"cores","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}]}],"title":"ContainersCPUusage","type":"row"},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":25},"id":38,"panels":[{"aliasColors":{},"bars":false,"datasource":"prometheus","decimals":3,"editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":13,"w":24,"x":0,"y":25},"id":20,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":true,"targets":[{"expr":"sum(rate(container_cpu_usage_seconds_total{id!=\"/\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(id)","hide":false,"interval":"10s","intervalFactor":1,"legendFormat":"{{id}}","metric":"container_cpu","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"AllprocessesCPUusage(1mavg)","tooltip":{"msResolution":true,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"show":true},"yaxes":[{"format":"none","label":"cores","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}]}],"repeat":null,"title":"AllprocessesCPUusage","type":"row"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":26},"id":39,"panels":[],"title":"Podsmemoryusage","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus","decimals":2,"editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":24,"x":0,"y":27},"id":25,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":200,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"connected","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":true,"targets":[{"expr":"sum(container_memory_working_set_bytes{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"})by(pod_name)","format":"time_series","interval":"10s","intervalFactor":1,"legendFormat":"{{pod_name}}","metric":"container_memory_usage:sort_desc","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Podsmemoryusage","tooltip":{"msResolution":false,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":34},"id":40,"panels":[{"aliasColors":{},"bars":false,"datasource":"prometheus","decimals":2,"editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":24,"x":0,"y":34},"id":26,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":200,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":true,"targets":[{"expr":"sum(container_memory_working_set_bytes{systemd_service_name!=\"\",kubernetes_io_hostname=~\"^$Node$\"})by(systemd_service_name)","interval":"10s","intervalFactor":1,"legendFormat":"{{systemd_service_name}}","metric":"container_memory_usage:sort_desc","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Systemservicesmemoryusage","tooltip":{"msResolution":false,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"show":true},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}]}],"title":"Systemservicesmemoryusage","type":"row"},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":35},"id":41,"panels":[{"aliasColors":{},"bars":false,"datasource":"prometheus","decimals":2,"editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":7,"w":24,"x":0,"y":35},"id":27,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":200,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":true,"targets":[{"expr":"sum(container_memory_working_set_bytes{image!=\"\",name=~\"^k8s_.*\",container_name!=\"POD\",kubernetes_io_hostname=~\"^$Node$\"})by(container_name,pod_name)","interval":"10s","intervalFactor":1,"legendFormat":"pod:{{pod_name}}|{{container_name}}","metric":"container_memory_usage:sort_desc","refId":"A","step":10},{"expr":"sum(container_memory_working_set_bytes{image!=\"\",name!~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"})by(kubernetes_io_hostname,name,image)","interval":"10s","intervalFactor":1,"legendFormat":"docker:{{kubernetes_io_hostname}}|{{image}}({{name}})","metric":"container_memory_usage:sort_desc","refId":"B","step":10},{"expr":"sum(container_memory_working_set_bytes{rkt_container_name!=\"\",kubernetes_io_hostname=~\"^$Node$\"})by(kubernetes_io_hostname,rkt_container_name)","interval":"10s","intervalFactor":1,"legendFormat":"rkt:{{kubernetes_io_hostname}}|{{rkt_container_name}}","metric":"container_memory_usage:sort_desc","refId":"C","step":10}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Containersmemoryusage","tooltip":{"msResolution":false,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"show":true},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}]}],"title":"Containersmemoryusage","type":"row"},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":36},"id":42,"panels":[{"aliasColors":{},"bars":false,"datasource":"prometheus","decimals":2,"editable":true,"error":false,"fill":0,"grid":{},"gridPos":{"h":13,"w":24,"x":0,"y":36},"id":28,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":200,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":true,"targets":[{"expr":"sum(container_memory_working_set_bytes{id!=\"/\",kubernetes_io_hostname=~\"^$Node$\"})by(id)","interval":"10s","intervalFactor":1,"legendFormat":"{{id}}","metric":"container_memory_usage:sort_desc","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"Allprocessesmemoryusage","tooltip":{"msResolution":false,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"show":true},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}]}],"title":"Allprocessesmemoryusage","type":"row"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":37},"id":43,"panels":[],"title":"PodsnetworkI/O","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"prometheus","decimals":2,"editable":true,"error":false,"fill":1,"grid":{},"gridPos":{"h":7,"w":24,"x":0,"y":38},"id":16,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":200,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"connected","paceLength":10,"percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(container_network_receive_bytes_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(pod_name)","interval":"10s","intervalFactor":1,"legendFormat":"->{{pod_name}}","metric":"network","refId":"A","step":10},{"expr":"-sum(rate(container_network_transmit_bytes_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(pod_name)","interval":"10s","intervalFactor":1,"legendFormat":"<-{{pod_name}}","metric":"network","refId":"B","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PodsnetworkI/O(1mavg)","tooltip":{"msResolution":false,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"Bps","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":45},"id":44,"panels":[{"aliasColors":{},"bars":false,"datasource":"prometheus","decimals":2,"editable":true,"error":false,"fill":1,"grid":{},"gridPos":{"h":7,"w":24,"x":0,"y":45},"id":30,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"sideWidth":200,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(container_network_receive_bytes_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(container_name,pod_name)","hide":false,"interval":"10s","intervalFactor":1,"legendFormat":"->pod:{{pod_name}}|{{container_name}}","metric":"network","refId":"B","step":10},{"expr":"-sum(rate(container_network_transmit_bytes_total{image!=\"\",name=~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(container_name,pod_name)","hide":false,"interval":"10s","intervalFactor":1,"legendFormat":"<-pod:{{pod_name}}|{{container_name}}","metric":"network","refId":"D","step":10},{"expr":"sum(rate(container_network_receive_bytes_total{image!=\"\",name!~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(kubernetes_io_hostname,name,image)","hide":false,"interval":"10s","intervalFactor":1,"legendFormat":"->docker:{{kubernetes_io_hostname}}|{{image}}({{name}})","metric":"network","refId":"A","step":10},{"expr":"-sum(rate(container_network_transmit_bytes_total{image!=\"\",name!~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(kubernetes_io_hostname,name,image)","hide":false,"interval":"10s","intervalFactor":1,"legendFormat":"<-docker:{{kubernetes_io_hostname}}|{{image}}({{name}})","metric":"network","refId":"C","step":10},{"expr":"sum(rate(container_network_transmit_bytes_total{rkt_container_name!=\"\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(kubernetes_io_hostname,rkt_container_name)","hide":false,"interval":"10s","intervalFactor":1,"legendFormat":"->rkt:{{kubernetes_io_hostname}}|{{rkt_container_name}}","metric":"network","refId":"E","step":10},{"expr":"-sum(rate(container_network_transmit_bytes_total{rkt_container_name!=\"\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(kubernetes_io_hostname,rkt_container_name)","hide":false,"interval":"10s","intervalFactor":1,"legendFormat":"<-rkt:{{kubernetes_io_hostname}}|{{rkt_container_name}}","metric":"network","refId":"F","step":10}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"ContainersnetworkI/O(1mavg)","tooltip":{"msResolution":false,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"show":true},"yaxes":[{"format":"Bps","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}]}],"title":"ContainersnetworkI/O","type":"row"},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":46},"id":45,"panels":[{"aliasColors":{},"bars":false,"datasource":"prometheus","decimals":2,"editable":true,"error":false,"fill":1,"grid":{},"gridPos":{"h":13,"w":24,"x":0,"y":46},"id":29,"isNew":true,"legend":{"alignAsTable":true,"avg":true,"current":true,"max":false,"min":false,"rightSide":false,"show":true,"sideWidth":200,"sort":"current","sortDesc":true,"total":false,"values":true},"lines":true,"linewidth":2,"links":[],"nullPointMode":"connected","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(container_network_receive_bytes_total{id!=\"/\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(id)","interval":"10s","intervalFactor":1,"legendFormat":"->{{id}}","metric":"network","refId":"A","step":10},{"expr":"-sum(rate(container_network_transmit_bytes_total{id!=\"/\",kubernetes_io_hostname=~\"^$Node$\"}[1m]))by(id)","interval":"10s","intervalFactor":1,"legendFormat":"<-{{id}}","metric":"network","refId":"B","step":10}],"thresholds":[],"timeFrom":null,"timeShift":null,"title":"AllprocessesnetworkI/O(1mavg)","tooltip":{"msResolution":false,"shared":true,"sort":2,"value_type":"cumulative"},"type":"graph","xaxis":{"show":true},"yaxes":[{"format":"Bps","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":false}]}],"title":"AllprocessesnetworkI/O","type":"row"}],"refresh":"10s","schemaVersion":18,"style":"dark","tags":["kubernetes"],"templating":{"list":[{"allValue":".*","current":{},"datasource":"prometheus","definition":"","hide":0,"includeAll":true,"label":null,"multi":false,"name":"Node","options":[],"query":"label_values(kubernetes_io_hostname)","refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-1h","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"browser","title":"lab04-Kubernetesclustermonitoring(viaprometheus)","uid":null,"version":1}
  website.json: |
    {"__requires":[{"type":"grafana","id":"grafana","name":"Grafana","version":"6.0.0-beta3"},{"type":"panel","id":"graph","name":"Graph","version":"5.0.0"},{"type":"datasource","id":"prometheus","name":"prometheus","version":"5.0.0"}],"annotations":{"list":[]},"editable":true,"gnetId":null,"graphTooltip":0,"id":null,"iteration":1551878859927,"links":[],"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":12,"x":0,"y":0},"id":8,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(rate(container_cpu_usage_seconds_total{container_name!=\"POD\",pod_name=~\"emojify-website-.*\",name=~\"^k8s_.*\"}[1m]))by(container_name)","format":"time_series","intervalFactor":1,"legendFormat":"{{container_name}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PodCPU","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":12,"x":12,"y":0},"id":10,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(container_memory_working_set_bytes{container_name!=\"POD\",name=~\"^k8s_.*\",pod_name=~\"emojify-api-.*\"})by(container_name)","format":"time_series","intervalFactor":1,"legendFormat":"{{container_name}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"PodMemory","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":6,"w":24,"x":0,"y":8},"id":2,"interval":"","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"increase(envoy_ext_authz_connect_authz_ok{label_app=\"emojify-website\"}[30s])","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{controller_name}}","refId":"A"},{"expr":"increase(envoy_ext_authz_connect_authz_error{label_app=\"emojify-website\"}[30s])","format":"time_series","intervalFactor":1,"legendFormat":"{{controller_name}}","refId":"B"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EnvoyAuthz","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":8,"w":24,"x":0,"y":14},"id":6,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":true,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_http_downstream_cx_total{envoy_http_conn_manager_prefix=\"ingress_website\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"total","refId":"A"},{"expr":"sum(increase(envoy_http_downstream_cx_active{envoy_http_conn_manager_prefix=\"ingress_website\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","intervalFactor":1,"legendFormat":"active","refId":"B"},{"expr":"sum(increase(envoy_http_downstream_cx_destroy_remote{envoy_http_conn_manager_prefix=\"ingress_website\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","intervalFactor":1,"legendFormat":"destroy-remote","refId":"C"},{"expr":"sum(increase(envoy_http_downstream_cx_destroy_local{envoy_http_conn_manager_prefix=\"ingress_website\",name=~\"^$pod_name$\"}[1m]))","format":"time_series","intervalFactor":1,"legendFormat":"destroy-local","refId":"D"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EnvoyConnectionsInbound(downstream)","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":true,"dashLength":10,"dashes":false,"fill":1,"gridPos":{"h":7,"w":24,"x":0,"y":22},"id":4,"interval":"","legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":false,"linewidth":1,"links":[],"nullPointMode":"null","paceLength":10,"percentage":false,"pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"stack":false,"steppedLine":false,"targets":[{"expr":"sum(increase(envoy_http_downstream_rq_xx{envoy_http_conn_manager_prefix=\"ingress_website\"}[30s]))by(controller_name,envoy_response_code_class)","format":"time_series","interval":"","intervalFactor":1,"legendFormat":"{{controller_name}}-{{envoy_response_code_class}}xx","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"EnvoyDownstreamRequests","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"refresh":"10s","schemaVersion":18,"style":"dark","tags":["emojify"],"templating":{"list":[{"allValue":null,"current":{},"datasource":"prometheus","definition":"query_result(sum(envoy_http_downstream_cx_total{envoy_http_conn_manager_prefix=\"ingress_website\"})by(name))","hide":0,"includeAll":true,"label":null,"multi":true,"name":"pod_name","options":[],"query":"query_result(sum(envoy_http_downstream_cx_total{envoy_http_conn_manager_prefix=\"ingress_website\"})by(name))","refresh":1,"regex":"/\"([^\"]+)\"/","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-30m","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"lab04-Website","uid":null,"version":4}